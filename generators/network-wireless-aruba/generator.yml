# Aruba Wireless Controller Event Generator
#
# Produces realistic Aruba ArubaOS wireless controller syslog events
# (ECS-compatible JSON) covering the full client lifecycle (association,
# 802.1X/web/MAC authentication, role assignment, deauthentication,
# disassociation), AP management (up/down), security events (rogue and
# interfering AP detection), and RF management (ARM channel changes).
#
# Usage:
#   eventum generate --path generators/network-wireless-aruba/generator.yml --id aruba-wlan --live-mode

input:
  - cron:
      expression: "* * * * * *"
      count: 5

event:
  template:
    mode: chance

    # Environment parameters — edit for your setup
    params:
      controller_hostname: aruba-mc01
      controller_ip: "192.168.1.1"
      ecs_version: "8.17.0"
      agent_id: "b2c3d4e5-f6a7-8901-bcde-f12345678901"
      agent_version: "8.17.0"
      client_pool_size: 150

    # Sample data
    samples:
      access_points:
        type: csv
        source: samples/access_points.csv
        header: true
      ssids:
        type: json
        source: samples/ssids.json
      usernames:
        type: csv
        source: samples/usernames.csv
        header: true

    # Event templates with realistic frequency distribution
    # Weights approximate a production enterprise WLAN (~50 APs, ~500 clients)
    templates:
      # Client association/authentication — dominant volume (~97%)
      - auth_success:
          template: templates/522008-auth-success.json.jinja
          chance: 250
      - auth_failed:
          template: templates/522275-auth-failed.json.jinja
          chance: 15
      - station_associated:
          template: templates/501030-station-associated.json.jinja
          chance: 200
      - user_authenticated:
          template: templates/501199-user-authenticated.json.jinja
          chance: 200
      - station_disassociated:
          template: templates/501060-station-disassociated.json.jinja
          chance: 150
      - user_deauthenticated:
          template: templates/501080-user-deauthenticated.json.jinja
          chance: 80
      - user_entry_deleted:
          template: templates/501217-user-entry-deleted.json.jinja
          chance: 80

      # AP management — ~1%
      - ap_up:
          template: templates/302004-ap-up.json.jinja
          chance: 8
      - ap_down:
          template: templates/302006-ap-down.json.jinja
          chance: 3

      # Security — ~1%
      - rogue_ap:
          template: templates/124001-rogue-ap.json.jinja
          chance: 5
      - interfering_ap:
          template: templates/404003-interfering-ap.json.jinja
          chance: 8

      # RF management — ~1%
      - channel_change:
          template: templates/500010-channel-change.json.jinja
          chance: 12

output:
  - file:
      path: output/events.json
      write_mode: overwrite
      formatter:
        format: json
